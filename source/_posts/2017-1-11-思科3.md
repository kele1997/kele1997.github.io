---
layout: post
title: "思科学习（3）"
date: 2017-1-11 13:07:37
author: "可乐"
catalog:
tags:
  -  学习使我快乐
  -  思科
  -  路由器

---
## 路由协议的作用   
管理路由路径和路由表    
route print      cmd命令打印路由表    
tracert 跟踪，超时不一定网页打不开   
## 路由协议和被路由协议的区别  
routing protocol   学习最佳路径    
routed protocol    根据最佳路径将来自上层的信息封装在IP包里传输  
## 路由器选路
路由器转发数据包的关键是路由表  
路由表显示的一定是最佳路径    
S 1.1.1.0/24 [1/0] VIA 10.1.1.1   
S static（静态）学习该条目的方式   
第二个1.1是目的条目（位置） 24 子网掩码  
1 表示管理距离  
0  表示度量   
via  之后的是下一跳   也可理解为网关 ，可以用物理口也可以用ip   
之后还可以有time 动态路由协议  周期  
## 路由
P226页  
多条路径负载均衡  
等价负载均衡，不等价负载均衡  
冗余，灾备功能  
路由表的一定是最佳路由     
管理路由信息   
## 常用路由协议的默认的ad值
直连 0   
静态 1    
>ad值：但路由器通过三种协议学到一个路由时，ad值用来判断哪个更容易被信任
>ad值越小，越容易被信任
>可以通过修改管理距离  管理协议    浮动静态路由    
>**ad值主要是一个路由器上进行比较，跨路由器比较毫无意义**
## 静态路由和动态路由
* 静态路由 ：手动添加，小型网络，节省资源（CPU,内存，带宽）  10台左右
* 动态路由：大型网络，占用一定资源，自动更新（触发，定期）  触发更新更好一些
* 静态路由只添加非直连条目即可，就是没有直接相连端口的   
## 静态路由的配置
* 无法反应网络的变化
* 网关写对端地址，还可以写自己的物理接口，使用物理接口，对端的ip地址可以随意修改
* 这是单方向的路径，必须还要配置一条相反的路径
* 静态路由的删除   no  ip route.............
* 多条ip route 删除，记事本中，查找替换   ip route >>>>no ip route 就删除了
* 缺省静态路由：三层设备支持路由，防火墙，路由器都是三层设备，路由的关键是路由表，公网的路由表很多，所以用缺省代替所有的路由条目，any（手动滑稽），缺省是在本地的端口缺省
* 缺省路由：一个路由只做一个缺省，不支持双接口
* ！.!.!.不符合条件的负载均衡，解决掉一个负载均衡，tracert跟踪，有一个跳转出现了两个跳转
# 静态路由的实验

-------------------------
# RIP
## 动态路由
* 有类路由协议  不支持VLSM    rip 其他的淘汰
* 无类   支持VLSM      eigrp  ripv2
* IGP(内部)        EGP（外部路由网关协议）      网通电信优先跑BGP，内部跑IGP
* 设计原理分：距离矢量 pass   度量值（metric）>>>hop跳级数？？不看带宽，看跳级数（跳过路由器的个数）
* 链路状态:ospf(企业) isis（运营商） cost=100M/BW（M）   BW最小带宽   度量值的计算metric值的计算
* 延迟：网络固定延迟（封装解封装，串行电路，两三毫秒）    可变延迟（GAME）缓冲电影      网络拥塞>>>慢，卡
* 给特殊流量预留带宽。   两个管理协议不能用同一个距离矢量，比不出来会比较hip值和cost值  （滑稽）
* 混合型路由协议：
* 有类广播   无类组播
* rip eigrp ospf
* 收敛时间      网络从不稳定到稳定的时间
## 路由回环
## 解决环路
* 水平分割：不会接受自身传达出去的信息
* 路由中毒：路由器将该路由器的条数标记为不可达 15跳最大 16跳不可达，超过16全为16
* 毒性逆转：
* 保持失效定时器：holddownk    路由器在holddown 时间内将该条记录标记为possiblely down 以使其它路由器能够...???????
* 触发更新：路由表变化是立即发送更新信息
## rip配置
* rip每30秒更新一次  最多6条路径，实现负载均衡，默认4条路径
* rip通过udp端口520操作      请求包  应答包
* 宣告的端口才会开启
* rip定时器    更新时间30    失效路由的等待时间180秒（holddown）    被抑制时间180秒 刷新定时器240秒（设置成无效路由并从路由表中删除）
* filter list 过滤列表
* 几种协议，先看最长匹配原则，再看距离
* clear ip route * 重新学习路由表，整个刷新一遍

**aaa**远程认证 drom登录啥的

**路由器的mac地址是可以修改的**